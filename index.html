
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ü—è—Ç–Ω–∞—à–∫–∏</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="gradient1">
  <h1>–ü—è—Ç–Ω–∞—à–∫–∏</h1>
  <div id="timer">00:00</div>
  <div id="moves">–•–æ–¥—ã: 0</div>
  <div id="controls">
    <button onclick="init()">–ó–∞–Ω–æ–≤–æ</button>
    <button onclick="undo()">–ù–∞–∑–∞–¥</button>
    <button id="toggleModeButton" onclick="toggleMode()">–†–µ–∂–∏–º: –ö–∞—Ä—Ç–∏–Ω–∫–∞</button>
    <button id="musicButton" onclick="toggleMusic()" class="icon-button">
      <svg id="musicIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polygon points="5 3 19 12 5 21 5 3"></polygon>
      </svg>
    </button>
    <button id="soundButton" onclick="toggleMoveSound()" class="icon-button">
      <svg id="soundIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M11 5L6 9H2v6h4l5 4V5z"></path>
        <line id="cross1" x1="23" y1="9" x2="17" y2="15"></line>
        <line id="cross2" x1="17" y1="9" x2="23" y2="15"></line>
      </svg>
    </button>
    <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="0.5" onchange="setVolume(this.value)">
    <select id="sizeSelector" onchange="changeSize(this.value)">
      <option value="4">4x4 (–°—Ç–∞–Ω–¥–∞—Ä—Ç)</option>
      <option value="3">3x3 (–ù–æ–≤–∏—á–æ–∫)</option>
      <!-- <option value="5">5x5 (–ü—Ä–æ—Ñ–∏)</option> -->
    </select>
    <!-- <select id="imageSelector" onchange="changeImage(this.value)">
      <option value="default">–î–µ–≤—É—à–∫–∞</option>
      <option value="saitama_genos">–°–∞–π—Ç–∞–º–∞ –∏ –ì–µ–Ω–æ—Å</option>
    </select> -->
    <select id="imageSelect">
    <option value="default">–°–∞–π—Ç–∞–º–∞ –∏ –ì–µ–Ω–æ—Å</option>
</select>

    <select id="bgSelector" onchange="changeBackground(this.value)">
      <option value="gradient1">–ì—Ä–∞–¥–∏–µ–Ω—Ç 1</option>
      <option value="gradient2">–ì—Ä–∞–¥–∏–µ–Ω—Ç 2</option>
      <option value="gradient3">–ì—Ä–∞–¥–∏–µ–Ω—Ç 3</option>
    </select>
  </div>
  <div id="board"></div>

  <audio id="bg-music" loop>
    <source src="fon_song.mp3" type="audio/mpeg">
  </audio>

  <audio id="move-sound">
    <source src="move.mp3" type="audio/mpeg">
  </audio>

  <audio id="win-sound">
    <source src="final_trimmed.mp3" type="audio/mpeg">
  </audio>

  <div id="winModal" class="modal">
    <div class="modal-content">
      <h2>üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
      <p id="winMessage"></p>
      <button onclick="restartGame()">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
    </div>
  </div>
  <div id="game-screen" class="screen">
  <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –∏ –ü—è—Ç–Ω–∞—à–∫–∏ -->
  <!-- –ú–∏–Ω–∏–º—É–º –∫–Ω–æ–ø–æ–∫: –ó–∞–Ω–æ–≤–æ, –°—Ç–∞—Ä—Ç, –ù–∞–∑–∞–¥, –ó–≤—É–∫, ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
</div>

<div id="settings-screen" class="screen hidden">
  <!-- –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: —Ä–∞–∑–º–µ—Ä –ø–æ–ª—è, –∫–∞—Ä—Ç–∏–Ω–∫–∏, —Ñ–æ–Ω -->
  <button onclick="backToGame()">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∏–≥—Ä—É</button>
</div>

  <script src="script.js"></script>
  <script>
    function toggleMusic() {
      const music = document.getElementById('bg-music');
      const musicIcon = document.getElementById('musicIcon');
      if (music.paused) {
        music.play();
        musicIcon.innerHTML = '<polygon points="5 3 19 12 5 21 5 3"></polygon>';
      } else {
        music.pause();
        musicIcon.innerHTML = '<rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect>';
      }
    }

    function setVolume(value) {
      const music = document.getElementById('bg-music');
      music.volume = value;
    }

    function toggleMoveSound() {
      moveSoundEnabled = !moveSoundEnabled;
      const soundIcon = document.getElementById('soundIcon');
      if (moveSoundEnabled) {
        soundIcon.innerHTML = '<path d="M11 5L6 9H2v6h4l5 4V5z"></path><line x1="23" y1="9" x2="17" y2="15"></line><line x1="17" y1="9" x2="23" y2="15"></line>';
      } else {
        soundIcon.innerHTML = '<path d="M11 5L6 9H2v6h4l5 4V5z"></path>';
      }
    }

    function changeBackground(value) {
      document.body.className = value;
    }

    function showWinModal() {
      const m = String(Math.floor(seconds / 60)).padStart(2, "0");
      const s = String(seconds % 60).padStart(2, "0");
      document.getElementById('winMessage').innerText = `–í—ã —Å–æ–±—Ä–∞–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫—É –∑–∞ ${m}:${s} –∏ ${moves} —Ö–æ–¥–æ–≤.`;

      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
      const bestTime = localStorage.getItem('bestTime');
      const bestMoves = localStorage.getItem('bestMoves');
      if (!bestTime || seconds < parseInt(bestTime)) {
        localStorage.setItem('bestTime', seconds);
      }
      if (!bestMoves || moves < parseInt(bestMoves)) {
        localStorage.setItem('bestMoves', moves);
      }

      const bestM = String(Math.floor(localStorage.getItem('bestTime') / 60)).padStart(2, "0");
      const bestS = String(localStorage.getItem('bestTime') % 60).padStart(2, "0");

      document.getElementById('winMessage').innerHTML += `<br>ü•á –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${bestM}:${bestS} –∏ ${localStorage.getItem('bestMoves')} —Ö–æ–¥–æ–≤`;

      document.getElementById('winModal').style.display = 'block';
      clearInterval(timer);
      playWinSound();
    }
  </script>
</body>
</html>
